<html>
<head>
  <link href="../imp.css" rel="stylesheet">
  <title>Space Geometry</title>
  <!--<script id="MathJax-script" async src="../MathJax/es5/tex-mml-chtml.js">-->
  <script id="MathJax-script" defer
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  </script>
</head>
<body>
  <h3>Rumlige objekter:</h3>
  Linjen:
  <div id="math-container1"></div>
  <br>
  Planen:
  <div id="math-container2"></div>
  <br>
  Cirklen:
  <br><br>
  <div id="math-container3"></div>
  <br><br>
  <button onclick="reset()">Nye</button>
  <br><br>
  Opgaver:<br>
  Bestem en ligning for planen(ligning1).<br>
  Bestem skæringspunktet mellem linjen og planen(P).<br>
  Bestem vinklen mellem linjen og planen(v).<br>
  Bestem ligningen for sfæren ved kvadratkomplettering(S).<br>
  Bestem skæringspunkterne mellem linjen og sfæren(\(S_{\pm}\).<br>
  Vælg en af følgende opgaver:<br>
  1. Undersøg om "ligning2" beskriver en tangentplan til sfæren.<br>
  2. Bestem tangentplanen til sfæren i punktet TP.<br><br>
  <div id="result"></div>
  <script defer src="https://www.geogebra.org/apps/deployggb.js"></script>
  <div id="ggb" style="width:1600px; height:600px;"></div>

  <script defer>


   // 1) Create + inject ONCE


     let ggb, q = [];
     const cmd = s => ggb ? ggb.evalCommand(s) : q.push(s);

     window.addEventListener("load", () => {
       new GGBApplet({
         appName: "3d",
         appletOnLoad(api) {
           ggb = api;
           while (q.length) ggb.evalCommand(q.shift());
         }
       }, true).inject("ggb");
     });




    class Vector{
      constructor(x){
        this.x=x
      }
      add(v){
        return new Vector([this.x[0]+v.x[0],this.x[1]+v.x[1],this.x[2]+v.x[2]])
      }
      mult(k){
        return new Vector([this.x[0]*k,this.x[1]*k,this.x[2]*k])
      }
      sub(v){
        return this.add(v.mult(-1))
      }
      dot(v){
        let S=0
        for(let i=0;i<v.x.length;i++){
          S+=this.x[i]*v.x[i]
        }
        return S
      }
      cross(v){
        return new Vector([this.x[1]*v.x[2]-this.x[2]*v.x[1],this.x[2]*v.x[0]-this.x[0]*v.x[2],this.x[0]*v.x[1]-this.x[1]*v.x[0]])
      }
      len(){
        let S=0
        for(let i=0;i<this.x.length;i++){
          S+=this.x[i]**2
        }
        return Math.sqrt(S)
      }
      round(){
        let S=[]
        for(let i=0;i<this.x.length;i++){
          S.push(Math.round(this.x[i]))
        }
        return new Vector(S)
      }
      str(){
        return `\\begin{pmatrix}
     ${Math.round(this.x[0]*100)/100} \\\\
     ${Math.round(this.x[1]*100)/100} \\\\
     ${Math.round(this.x[2]*100)/100}
   \\end{pmatrix}`;
      }
      gStr(){
        return `(${Math.round(this.x[0]*100)/100},${Math.round(this.x[1]*100)/100},${Math.round(this.x[2]*100)/100})`
      }
    }
    function reset(){
        a = new Vector([Math.round(20*Math.random())-10,Math.round(20*Math.random())-10,Math.round(20*Math.random())-10]); // Generate a random number between 0 and 1
        b = new Vector([Math.round(20*Math.random())-10,Math.round(20*Math.random())-10,Math.round(20*Math.random())-10]);
        c = new Vector([Math.round(20*Math.random())-10,Math.round(20*Math.random())-10,Math.round(20*Math.random())-10]);
        math = `\\( p(s,t) = ${a.str()}s+${b.str()}t+${c.str()} \\)`;
        document.getElementById('math-container2').innerHTML = math;
        n = a.cross(b)
        cmd(`p(s,t)=${a.gStr()}s+${b.gStr()}t+${c.gStr()}`);
        cmd(`plan:0=${n.x[0]}x+${n.x[1]}y+${n.x[2]}z+${-n.dot(c)}`);
        a= new Vector([Math.round(20*Math.random())-10,Math.round(20*Math.random())-10,Math.round(20*Math.random())-10]);
        b = new Vector([Math.round(20*Math.random())-10,Math.round(20*Math.random())-10,Math.round(20*Math.random())-10]);
        math = `\\( s(t) = ${a.str()}t+${b.str()} \\)`;
        document.getElementById('math-container1').innerHTML = math;
        cmd(`s(t)=${a.gStr()}t+${b.gStr()}`);
        cmd(`P=Intersect(s,plan)`);
        cmd(`v=Angle(s,plan)`);
        cmd(`n=Vector(${c.gStr()},${c.gStr()}+${n.mult(1/n.len()).gStr()})`);
        temp=new Vector([2*Math.random()-1,2*Math.random()-1,2*Math.random()-1]).mult(10);
        temp2=5*(2*Math.random()-1)
        c=a.mult(temp2).add(b).add(temp).round();
        r=Math.sqrt(Math.round(temp.len()**2));
        math = `\\(0=x^2${c.x[0]<0?"+":"-"}${2*Math.abs(c.x[0])}x+y^2${c.x[1]<0?"+":"-"}${2*Math.abs(c.x[1])}y+z^2${c.x[2]<0?"+":"-"}${2*Math.abs(c.x[2])}z${c.dot(c)-r**2<0?"":"+"}${Math.round(c.dot(c)-r**2)}\\)`;
        document.getElementById('math-container3').innerHTML = math;
        cmd(`S=Sphere(${c.gStr()},${r})`);
        temp=new Vector([2*Math.random()-1,2*Math.random()-1,0]).mult(r/Math.sqrt(2))
        temp.x[2]=Math.sqrt(r**2-temp.x[0]**2-temp.x[1]**2)
        cmd(`tangentplan:0=${temp.x[0]}x+${temp.x[1]}y+${temp.x[2]}z+${-temp.dot(c.add(temp))}`);
        cmd(`TP=${c.add(temp).gStr()}`);
        d=a.dot(b.sub(c))**2-a.dot(a)*(b.sub(c).dot(b.sub(c))-r**2)
        cmd(`S_+=${a.mult((-a.dot(b.sub(c))+Math.sqrt(d))/a.dot(a)).add(b).gStr()}`);
        cmd(`S_-=${a.mult((-a.dot(b.sub(c))-Math.sqrt(d))/a.dot(a)).add(b).gStr()}`);
        MathJax.typesetPromise(); // Render MathJax
    }
    reset()
  </script>
</body>
